<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="community">

<select id = "comBoardCount" resultType = "int" parameterType = "String">
	select count(*) from community where boardid = #{boardid}
</select> 
<select id = "comBoardList" resultType = "community"  parameterType = "map">
	select  * from (select rownum rnum, a.* from (
	select * from community where boardid = #{boardid} order by ref desc, refstep asc) a)
	where rnum between #{start} and #{end}
</select> 

<select id = "comBoardOne" resultType = "community" parameterType ="int">
	select * from community where num = #{num}
</select>


<insert id = "comInsertBoard" parameterType = "community">
	insert into community  values (#{num}, #{subject}, #{content},#{tag},#{likes},#{boardid}
			,sysdate,#{ip},0,#{ref},#{reflevel},#{refstep})
</insert>

<select id = "comNextNum" resultType = "int">
	select comboard_seq.nextval from dual
</select>

<update id = "comBoardUpdate" parameterType = "community">
	update community set subject = #{subject}, content = #{content},
			tag = #{tag} where num = #{num}
</update>

<delete id="comBoardDelete" parameterType= "int">
	delete from community where num = #{num}
</delete>

<!-- 메인화면 최신글 보드 리스트 -->
<select id = "comMainBoardList" resultType = "community" parameterType = "string">
    select ROWNUM  , A.* from 
    (select * from COMMUNITY where BOARDID = #{boardId} order by num desc) 
    A 
    where ROWNUM &lt; 5
</select> 

</mapper>
